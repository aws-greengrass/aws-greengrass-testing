#
# Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
# SPDX-License-Identifier: Apache-2.0
#

---
RecipeFormatVersion: 2020-01-25
ComponentName: aws.greengrass.secret
ComponentVersion: '1.0.0'
ComponentDescription: This is Secret component.
ComponentPublisher: Amazon
ComponentConfiguration:
  DefaultConfiguration:
    assertionServerPort: 8080
    secretName: EGUAT
    secretValue: password
    accessControl:
      aws.greengrass.SecretManager:
        policyId1:
          policyDescription: access to secret
          operations:
            - 'aws.greengrass#GetSecretValue'
          resources:
            - '*'
Manifests:
  - Artifacts:
      - URI: file:target/aws-greengrass-testing-features-mqtt.zip
        Unarchive: ZIP
        Permission:
          Read: ALL
          Execute: ALL
    Lifecycle:
      Run: |
        java -Dipc.operation="secretManager" -DcomponentName="aws.greengrass.secretComponents" -jar {artifacts:decompressedPath}/aws-greengrass-testing-features-mqtt/aws-greengrass-testing-features-mqtt/ggipc-component.jar {configuration:/secretName} {configuration:/secretValue}